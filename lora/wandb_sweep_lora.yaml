# Weights & Biases sweep for LoRA crouch adaptation
# Run with:
#   wandb sweep lora/wandb_sweep_lora.yaml
#   wandb agent <entity>/<project>/<sweep_id>
program: lora/train_lora_adapter.py
command:
  - ${env}
  - ${interpreter}
  - ${program}
  - --checkpoint
  - /home/ghlee/GaitDynamics/example_usage/GaitDynamicsDiffusion.pt
  - --window_len
  - "150"
  - --target_sampling_rate
  - "100"
method: bayes
metric:
  name: train/epoch_loss
  goal: minimize
parameters:
  # Core LoRA hyperparams
  lora_r:
    values: [8, 16, 32]
  lora_alpha:
    values: [16, 32, 64]
  lora_dropout:
    values: [0.0, 0.05, 0.1]
  # Optimization
  lr:
    values: [0.0005, 0.001, 0.002]
  weight_decay:
    values: [0.0, 0.0001]
  grad_clip:
    values: [0.5, 1.0]
  batch_size:
    values: [8, 16]
  epochs:
    value: 100
  log_every:
    value: 50
  # Dataset and misc (override via env if needed)
  data_root:
    value: gdp_ld_crouch_split
  window_len:
    value: 150
  target_sampling_rate:
    value: 100
  # Naming
  wandb_name:
    value: lora_crouch_sweep
